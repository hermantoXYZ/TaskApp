{% load static %}
{% load i18n %}

<!DOCTYPE html>
<html lang="id" class="light-style">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />

    <title>{{ agenda.title }} - Materi Pembelajaran</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">

    <style>
        body {
            background-color: #f5f5f9;
            font-family: "Public Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
            color: #566a7f;
        }
        .card {
            border: 0;
            box-shadow: 0 2px 6px 0 rgba(67, 89, 113, 0.12);
            border-radius: 0.5rem;
        }
        .accordion-button {
            box-shadow: none !important;
        }
        .accordion-button:not(.collapsed) {
            color: #696cff;
            background-color: #e7e7ff;
        }
        .accordion-button::after {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23696cff'%3E%3Cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3E%3C/svg%3E");
        }
    </style>
</head>

<body>

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            
            <div class="card bg-primary text-white mb-4">
                <div class="card-body p-4 text-center">
                    <span class="badge bg-white text-primary bg-opacity-25 mb-2 rounded-pill px-3">
                        {{ course.code }} - {{ course.group }}
                    </span>
                    <h4 class="text-white fw-bold mb-1">{{ agenda.title }}</h4>
                    <p class="opacity-75 mb-0 small">
                        <i class="ri-calendar-event-line me-1"></i> {{ agenda.agenda_date|date:"l, d F Y" }} 
                        <span class="mx-2">|</span>
                        <i class="ri-map-pin-line me-1"></i> {{ agenda.location|default:"Online" }}
                    </p>
                    
                    {% if agenda.description %}
                    <div class="mt-3 small opacity-75 mx-auto border-top border-white border-opacity-25 pt-3" style="max-width: 90%;">
                        {{ agenda.description|linebreaksbr }}
                    </div>
                    {% endif %}
                </div>
            </div>

            <h5 class="mb-3 text-muted">Daftar Materi ({{ materials.count }})</h5>

            {% if materials %}
                <div class="accordion" id="accordionMaterials">
                
                {% for mat in materials %}
                  <div class="accordion-item card mb-3 overflow-hidden">
                    <h2 class="accordion-header" id="heading-{{ mat.id }}">
                      <button type="button" class="accordion-button {% if not forloop.first %}collapsed{% endif %}" data-bs-toggle="collapse" data-bs-target="#collapse-{{ mat.id }}" aria-expanded="{% if forloop.first %}true{% else %}false{% endif %}" aria-controls="collapse-{{ mat.id }}">
                        
                        {% if mat.material_type == 'video' %}
                            <i class="ri-play-circle-fill ri-24px me-2 text-danger"></i>
                        {% elif mat.material_type == 'reading' %}
                            <i class="ri-article-fill ri-24px me-2 text-info"></i>
                        {% elif mat.material_type == 'quiz' %}
                            <i class="ri-questionnaire-fill ri-24px me-2 text-warning"></i>
                        {% else %}
                            <i class="ri-file-text-fill ri-24px me-2 text-primary"></i>
                        {% endif %}

                        <span class="fw-semibold me-auto">{{ mat.title }}</span>
                        
                        {% if mat.duration_seconds > 0 %}
                            <small class="text-muted fw-normal me-2">{{ mat.duration_seconds|divisibleby:60 }} Min</small>
                        {% endif %}
                      </button>
                    </h2>

                    <div id="collapse-{{ mat.id }}" class="accordion-collapse collapse {% if forloop.first %}show{% endif %}" aria-labelledby="heading-{{ mat.id }}" data-bs-parent="#accordionMaterials">
                      <div class="accordion-body pt-0">
                        
                        {% if mat.text_content %}
                            <p class="text-secondary small mb-3">{{ mat.text_content }}</p>
                        {% endif %}

                        <div class="d-flex gap-2 mt-2">
                            {% if mat.video_url %}
                                <a href="{{ mat.video_url }}" target="_blank" class="btn btn-sm btn-outline-danger rounded-pill">
                                    <i class="ri-youtube-fill me-1"></i> Tonton
                                </a>
                            {% endif %}
                            
                            {% if mat.file_attachment %}
                                <a href="{{ mat.file_attachment.url }}" download class="btn btn-sm btn-outline-primary rounded-pill">
                                    <i class="ri-download-cloud-2-line me-1"></i> Download
                                </a>
                            {% endif %}
                        </div>

                      </div>
                    </div>
                  </div>
                {% endfor %}

                </div>
            {% else %}
                <div class="text-center py-5 card">
                    <div class="card-body">
                        <i class="ri-folder-open-line text-muted" style="font-size: 3rem; opacity: 0.5;"></i>
                        <h6 class="text-muted mt-2">Belum ada materi.</h6>
                    </div>
                </div>
            {% endif %}

            <div class="text-center mt-5 mb-5 text-muted small">
                &copy; {% now "Y" %} {{ course.name }}<br>
                Learning Management System
            </div>

        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>