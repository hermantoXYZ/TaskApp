{% extends layout_path %}

{% load static %}
{% load i18n %}

{% block title %}Academy - My Courses - App{% endblock %}

{% block vendor_css %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'vendor/libs/select2/select2.css' %}" />
<link rel="stylesheet" href="{% static 'vendor/libs/plyr/plyr.css' %}" />
{% endblock vendor_css %}

{% block vendor_js %}
{{ block.super }}
<script src="{% static 'vendor/libs/select2/select2.js' %}"></script>
<script src="{% static 'vendor/libs/plyr/plyr.js' %}"></script>
{% endblock vendor_js %}

{% block page_css %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'vendor/css/pages/app-academy.css' %}" />
{% endblock page_css %}

{% block page_js %}
{{ block.super }}
<script src="{% static 'js/app-academy-course.js' %}"></script>
{% endblock page_js %}

{% block content %}
<div class="app-academy">
  
  <div class="card p-0 mb-6">
    <div class="card-body d-flex flex-column flex-md-row justify-content-between p-0 pt-6">
      <div class="app-academy-md-25 card-body py-0 pt-6 ps-12">
        <img src="{% static 'img/illustrations/bulb-' %}{{ COOKIES.style|default:style }}.png" class="img-fluid app-academy-img-height scaleX-n1-rtl" alt="Bulb in hand" data-app-light-img="illustrations/bulb-light.png" data-app-dark-img="illustrations/bulb-dark.png" height="90" />
      </div>
      <div class="app-academy-md-50 card-body d-flex align-items-md-center flex-column text-md-center mb-6 py-6">
        <span class="card-title mb-4 lh-lg px-md-12 h4 text-heading">
          Selamat Datang, {{ request.user.first_name|default:request.user.username }}<br>
        </span>
        <p class="mb-4 px-0 px-md-2">
          Akses materi perkuliahan, tugas dengan mudah tanpa hambatan..<br>
        </p>
        <div class="d-flex align-items-center justify-content-between app-academy-md-80">
          <input type="search" placeholder="Cari mata kuliah..." class="form-control form-control-sm me-4" />
          <button type="submit" class="btn btn-primary btn-icon"><i class="ri-search-line ri-22px"></i></button>
        </div>
      </div>
      <div class="app-academy-md-25 d-flex align-items-end justify-content-end">
        <img src="{% static 'img/illustrations/pencil-rocket.png' %}" alt="pencil rocket" height="180" class="scaleX-n1-rtl" />
      </div>
    </div>
  </div>

  <div class="card mb-6">
    <div class="card-header d-flex flex-wrap justify-content-between gap-4">
      <div class="card-title mb-0 me-1">
        <h5 class="mb-0">Mata Kuliah Saya</h5>
        <p class="mb-0 text-body">Total {{ my_courses.count }} mata kuliah diambil.</p>
      </div>
      <div class="d-flex justify-content-md-end align-items-center gap-6 flex-wrap">
        <select class="form-select form-select-sm w-px-250">
          <option value="all">Semua</option>
          <option value="active">Aktif</option>
          <option value="completed">Selesai</option>
        </select>

        <div class="form-check form-switch mb-0">
          <input type="checkbox" class="form-check-input" id="CourseSwitch" checked />
          <label class="form-check-label text-nowrap mb-0" for="CourseSwitch">Sembunyikan Selesai</label>
        </div>
      </div>
    </div>

    <div class="card-body mt-1">
      <div class="row gy-6 mb-6">
        
        {% if my_courses %}
            {% for course in my_courses %}
            <div class="col-sm-6 col-lg-4">
              <div class="card p-2 h-100 shadow-none border rounded-3">
                <div class="rounded-4 text-center mb-5">
                  <a href="{% url 'course-player' course.uuid %}">
                    <img class="img-fluid" src="{% static 'img/pages/app-academy-tutor-' %}{% cycle '1' '2' '3' '4' '5' '6' %}.png" alt="tutor image">
                  </a>
                </div>
                <div class="card-body p-3 pt-0">
                  <div class="d-flex justify-content-between align-items-center mb-4">
                    <span class="badge rounded-pill bg-label-primary">{{ course.prodi.nama_prodi }}</span>
                    <p class="d-flex align-items-center justify-content-center fw-medium gap-1 mb-0">
                       {{ course.credit_t }} <span class="fw-normal">SKS</span>
                    </p>
                  </div>
                  
                  <a href="{% url 'course-player' course.uuid %}" class="h5">{{ course.name }}</a>
                  <p class="text-muted small mb-1">{{ course.code }}</p>
                  
                  <p class="mt-1">{{ course.description|truncatewords:8 }}</p>
                  
                  <div class="d-flex flex-column gap-1 mb-3">
                      <p class="d-flex align-items-center mb-0 text-muted small">
                        <i class="ri-time-line ri-16px me-1"></i>{{ course.duration_weeks }} Minggu
                      </p>
                      <p class="d-flex align-items-center mb-0 text-muted small">
                        <i class="ri-user-voice-line ri-16px me-1"></i>
                        {% for coach in course.coaches.all|slice:":1" %}
                            {{ coach.nip.first_name }}
                        {% empty %}
                            Tim Dosen
                        {% endfor %}
                        {% if course.coaches.count > 1 %} +{{ course.coaches.count|add:"-1" }} others{% endif %}
                      </p>
                  </div>

                  <div class="d-flex align-items-center justify-content-between mb-1">
                    <span class="small">Progress</span>
                    <span class="small">0%</span>
                  </div>
                  <div class="progress rounded-pill mb-4" style="height: 8px">
                    <div class="progress-bar w-0" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                  </div>

                  <div class="d-flex flex-column flex-md-row gap-4 text-nowrap flex-wrap flex-md-nowrap flex-lg-wrap flex-xxl-nowrap">
                    <a class="w-100 btn btn-outline-primary d-flex align-items-center justify-content-center" href="{% url 'course-player' course.uuid %}">
                      <span class="me-2">Masuk Kelas</span><i class="ri-arrow-right-line ri-16px lh-1 scaleX-n1-rtl"></i>
                    </a>
                  </div>
                </div>
              </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="col-12 text-center py-12">
                <div class="d-flex flex-column align-items-center">
                    <span class="avatar-initial rounded-3 bg-label-secondary mb-3 p-4">
                        <i class="ri-book-open-line ri-48px"></i>
                    </span>
                    <h4>Belum ada Mata Kuliah</h4>
                    <p class="text-muted">Anda belum terdaftar di mata kuliah manapun pada periode ini.</p>
                </div>
            </div>
        {% endif %}

      </div>

      {% if my_courses.count > 6 %}
      <nav aria-label="Page navigation" class="d-flex align-items-center justify-content-center">
        <ul class="pagination mb-0">
          <li class="page-item prev"><a class="page-link" href="javascript:void(0);"><i class="tf-icon ri-arrow-left-s-line ri-22px"></i></a></li>
          <li class="page-item active"><a class="page-link" href="javascript:void(0);">1</a></li>
          <li class="page-item next"><a class="page-link" href="javascript:void(0);"><i class="tf-icon ri-arrow-right-s-line ri-22px"></i></a></li>
        </ul>
      </nav>
      {% endif %}
    </div>
  </div>

  <div class="row gy-4 mb-6">
    <div class="col-lg-6">
      <div class="card shadow-none bg-label-info h-100">
        <div class="card-body d-flex justify-content-between flex-wrap-reverse">
          <div class="mb-0 w-100 app-academy-sm-60 d-flex flex-column justify-content-between text-center text-sm-start">
            <div class="card-title">
              <h5 class="text-info mb-2">Panduan </h5>
              <p class="text-heading w-sm-80 app-academy-xl-100">
                Unduh panduan akademik dan peraturan kemahasiswaan terbaru disini.
              </p>
            </div>
            <div class="mb-0"><button class="btn btn-sm btn-info">Lihat Panduan</button></div>
          </div>
          <div class="w-100 app-academy-sm-40 d-flex justify-content-center justify-content-sm-end h-px-150 mb-4 mb-sm-0">
            <img class="img-fluid scaleX-n1-rtl" src="{% static 'img/illustrations/boy-app-academy.png' %}" alt="boy illustration" />
          </div>
        </div>
      </div>
    </div>
    <div class="col-lg-6">
      <div class="card shadow-none bg-label-danger h-100">
        <div class="card-body d-flex justify-content-between flex-wrap-reverse">
          <div class="mb-0 w-100 app-academy-sm-60 d-flex flex-column justify-content-between text-center text-sm-start">
            <div class="card-title">
              <h5 class="text-danger mb-2">Jadwal Agenda</h5>
              <p class="text-heading app-academy-sm-60 app-academy-xl-100">
                Cek jadwal ujian tengah semester dan akhir semester Anda.
              </p>
            </div>
            <div class="mb-0"><button class="btn btn-sm btn-danger">Lihat Jadwal</button></div>
          </div>
          <div class="w-100 app-academy-sm-40 d-flex justify-content-center justify-content-sm-end h-px-150 mb-4 mb-sm-0">
            <img class="img-fluid scaleX-n1-rtl" src="{% static 'img/illustrations/girl-app-academy.png' %}" alt="girl illustration" />
          </div>
        </div>
      </div>
    </div>
  </div>

  
</div>
{% endblock %}